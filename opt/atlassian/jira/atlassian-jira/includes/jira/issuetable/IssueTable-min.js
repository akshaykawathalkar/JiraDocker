define("jira/issuetable",["jquery","underscore","backbone","jira/skate","jira/ajs/dark-features"],function($,_,Backbone,Skate,DarkFeatures){var impl=(function(impl){_.extend(impl,Backbone.Events);return impl})({sortable:{},enabled:false,sequence:function(row){var rows=$(row).parent().children();for(var index=0;index<rows.length;index++){if(rows[index]===row){return index}}return -1},ready:function(){if(DarkFeatures.isEnabled("com.atlassian.jira.issuetable.draggable")&&this.enabled){$("#issuetable tbody").sortable("destroy");$("#issuetable tbody").sortable(this.sortable);$("#issuetable tbody tr").addClass("issue-table-draggable")}},cancelDragging:function(){$("#issuetable tbody").sortable("cancel")},enableDragging:function(){this.enabled=true;this.ready()},setupDragging:function(settings){this.sortable=settings;this.ready()}});var api={Events:{ON_INIT:"jira-issuetable-web-component-ready",ON_ROW_DRAG:"jira-issuetable-web-component-row-drag"},on:function(event,callback){impl.on(event,callback);if(event===this.Events.ON_ROW_DRAG){impl.enableDragging()}},cancelDragging:function(){impl.cancelDragging()}};Skate("issuetable-web-component",{attached:function(){impl.setupDragging((function(position){return{items:"> tr",appendTo:"parent",helper:"clone",start:function(event,ui){position.original=impl.sequence(ui.item[0])},stop:function(event,ui){position.current=impl.sequence(ui.item[0]);if(position.original>=0&&position.current>=0){impl.trigger(api.Events.ON_ROW_DRAG,{position:position,table:$("#issuetable")[0],row:ui.item[0]})}else{console.warn("Unable to calculate index number of row being moved");impl.cancelDragging()}}}})({original:-1,current:-1}));impl.trigger(api.Events.ON_INIT,{})}});return api});