define("jira/viewissue/init-comment-areas",["require"],function(require){var commentForm=require("jira/viewissue/comment/comment-form");var footerComment=require("jira/viewissue/comment/footer-comment");var IssueApi=require("jira/issue");var $=require("jquery");var parseUri=require("jira/libs/parse-uri");var oldBeforeUnload=window.onbeforeunload;var commentArea={};commentArea.openFooterComment=function openFooterComment(){footerComment.show();commentForm.getForm().find("#commentLevel").bind("change",function(){commentForm.setSubmitState()});commentForm.setSubmitState()};$(document).delegate("#addcomment #issue-comment-add","submit",function(e){footerComment.ajaxSubmit();e.preventDefault()}).delegate(".issue-header #comment-issue","click",function(e){footerComment.show();e.preventDefault()}).delegate("#footer-comment-button","click",function(e){commentArea.openFooterComment();e.preventDefault()}).delegate("#addcomment .cancel","click",function(e){e.preventDefault();footerComment.hide(true)}).delegate("#issue-comment-add","submit",function(){window.setTimeout(function(){commentForm.disable()},0)}).delegate("#issue-comment-add #comment","input",function(){commentForm.setSubmitState()}).delegate("#issue-comment-add input[type='submit']","click",function(e){if(commentForm.showNoCommentMsg()){e.preventDefault()}}).bind("showWikiInput",function(){footerComment.setPreviewMode(false);var $commentField=commentForm.getField();if($commentField.is(":visible:enabled")){IssueApi.getStalker().trigger("stalkerHeightUpdated");if($commentField.length>0){$commentField.focus()}commentForm.setCaretAtEndOfCommentField()}}).bind("showWikiPreview",function(){footerComment.setPreviewMode(true);IssueApi.getStalker().trigger("stalkerHeightUpdated")});window.onbeforeunload=function(){var oldResult=undefined;if($.isFunction(oldBeforeUnload)){oldResult=oldBeforeUnload.apply(this,arguments)}return oldResult||commentForm.handleBrowseAway.apply(this,arguments)};$(function(){if(parseUri(window.location.href).anchor==="add-comment"){commentArea.openFooterComment()}})});define("jira/viewissue/invoke-comment-trigger",["jquery"],function($){return function invokeCommentTrigger(){var addIssueComment=$(".add-issue-comment");if(addIssueComment.length===0){return }var toolbarTrigger=addIssueComment.filter(".toolbar-trigger");if(toolbarTrigger.length>0){toolbarTrigger.click()}else{addIssueComment.click()}}});(function(){var commentForm=require("jira/viewissue/comment/comment-form");AJS.namespace("JIRA.Issue.CommentForm",null,commentForm);AJS.namespace("JIRA.Issue.getDirtyCommentWarning",null,commentForm.handleBrowseAway);AJS.namespace("JIRA.Issue.invokeCommentTrigger",null,require("jira/viewissue/invoke-comment-trigger"))})();